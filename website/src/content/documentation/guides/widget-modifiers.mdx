---
title: Widget Modifiers
---

import { Callout } from "nextra/components";

# Widget Modifiers

Modifiers wrap a widget with another widget (like `Transform`, `Padding`, or `Opacity`) to add effects without changing the widget tree. All modifier methods start with `wrap`.

## How Modifiers Work

`wrapOpacity` wraps a widget with `Opacity`:

```dart
import 'package:flutter/material.dart';
import 'package:mix/mix.dart';

final style = BoxStyler()
    .color(Colors.red)
    .size(100, 100)
    .wrapOpacity(0.4);
```

This produces a widget tree equivalent to `Opacity(opacity: 0.4, child: Container(...))`.

## Built-in Modifiers

| Method | Description | Wrapper Widget |
|--------|-------------|----------------|
| `.wrapOpacity(value)` | Sets opacity | `Opacity` |
| `.wrapPadding(insets)` | Adds padding | `Padding` |
| `.wrapAlign(alignment)` | Sets alignment | `Align` |
| `.wrapAspectRatio(ratio)` | Constrains aspect ratio | `AspectRatio` |
| `.wrapFlexible(flex, fit)` | Makes flexible in Flex layouts | `Flexible` |
| `.wrapScale(scale)` | Applies scale transform | `Transform.scale` |
| `.wrapRotate(angle)` | Applies rotation transform | `Transform.rotate` |
| `.wrapVisibility(visible)` | Shows/hides widget | `Visibility` |
| `.wrapClipRect()` | Clips to rectangle | `ClipRect` |
| `.wrapClipRRect(radius)` | Clips to rounded rectangle | `ClipRRect` |
| `.wrapClipOval()` | Clips to oval | `ClipOval` |

### Usage Examples

```dart
import 'package:flutter/material.dart';
import 'package:mix/mix.dart';

// Combine multiple modifiers
final cardStyle = BoxStyler()
    .color(Colors.white)
    .size(200, 100)
    .wrapOpacity(0.9)
    .wrapPadding(EdgeInsets.all(16))
    .wrapAlign(Alignment.center);

// Animated scale on hover
final buttonStyle = BoxStyler()
    .color(Colors.blue)
    .paddingAll(16)
    .wrapScale(1.0)
    .onHovered(BoxStyler().wrapScale(1.1));
```

## Modifier Ordering

Modifiers are applied from innermost to outermost in the order they are chained. This means the last modifier in the chain becomes the outermost wrapper:

```dart
// Result: Align → Opacity → Padding → Box
final style = BoxStyler()
    .wrapPadding(EdgeInsets.all(8))  // innermost wrapper
    .wrapOpacity(0.5)                 // middle wrapper
    .wrapAlign(Alignment.center);     // outermost wrapper
```

<Callout type="info">
  The order of modifiers matters. Padding applied before opacity will have its padding inside the opacity effect, while padding after opacity will be outside.
</Callout>

## Creating Custom Modifiers

Create custom modifiers with two classes:

1. **WidgetModifier** - Builds the wrapper widget
2. **ModifierMix** - Handles merging and resolving

### Step 1: Create the WidgetModifier

```dart
import 'package:flutter/widgets.dart';
import 'package:mix/mix.dart';

/// Modifier that applies opacity to its child.
final class OpacityModifier extends WidgetModifier<OpacityModifier> {
  /// Opacity value between 0.0 and 1.0 (inclusive).
  final double opacity;

  const OpacityModifier([double? opacity]) : opacity = opacity ?? 1.0;

  @override
  OpacityModifier copyWith({double? opacity}) {
    return OpacityModifier(opacity ?? this.opacity);
  }

  @override
  OpacityModifier lerp(OpacityModifier? other, double t) {
    if (other == null) return this;
    // Linear interpolation for smooth animations
    return OpacityModifier(MixOps.lerp(opacity, other.opacity, t)!);
  }

  @override
  List<Object?> get props => [opacity];

  @override
  Widget build(Widget child) {
    return Opacity(opacity: opacity, child: child);
  }
}
```

Key methods to implement:

| Method | Purpose |
|--------|---------|
| `copyWith` | Creates a copy with optional property updates |
| `lerp` | Linear interpolation for animations between two modifier states |
| `props` | List of properties for equality comparison |
| `build` | Constructs the wrapper widget |

### Step 2: Create the ModifierMix

The `ModifierMix` class makes the modifier mergeable and resolvable. It uses `Prop<T>` for properties to support tokens and lazy resolution.

```dart
import 'package:flutter/widgets.dart';
import 'package:mix/mix.dart';

/// Mix class for applying opacity modifications.
class OpacityModifierMix extends ModifierMix<OpacityModifier> {
  final Prop<double>? opacity;

  const OpacityModifierMix.create({this.opacity});

  /// Convenience constructor with direct value
  OpacityModifierMix({double? opacity})
      : this.create(opacity: Prop.maybe(opacity));

  @override
  OpacityModifier resolve(BuildContext context) {
    return OpacityModifier(opacity?.resolveProp(context));
  }

  @override
  OpacityModifierMix merge(OpacityModifierMix? other) {
    if (other == null) return this;

    return OpacityModifierMix.create(
      opacity: MixOps.merge(opacity, other.opacity),
    );
  }

  @override
  List<Object?> get props => [opacity];
}
```

Key methods:

| Method | Purpose |
|--------|---------|
| `resolve` | Resolves `Prop` values using BuildContext and creates the final `WidgetModifier` |
| `merge` | Combines two `ModifierMix` instances, with other's values taking precedence |
| `props` | List of properties for equality comparison |

### Step 3: Use the Custom Modifier

To use your custom modifier in a style, use the `.wrap()` method:

```dart
import 'package:flutter/material.dart';
import 'package:mix/mix.dart';

final style = BoxStyler()
    .color(Colors.red)
    .size(100, 100)
    .wrap(OpacityModifierMix(opacity: 0.4));

// With tokens
final $opacityToken = DoubleToken('custom.opacity');

final tokenStyle = BoxStyler()
    .color(Colors.blue)
    .wrap(OpacityModifierMix.create(opacity: Prop.token($opacityToken)));
```

## Best Practices

- Use modifiers for transforms, visibility, layout adjustments, and clipping
- Use styler methods (not modifiers) for colors, borders, shadows
- Avoid deeply nested modifier chains
- Implement `lerp` properly for smooth animations
